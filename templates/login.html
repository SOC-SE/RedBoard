{{ template "head.html" . }}

<div class="login-container">
    <div class="login-card" x-data="loginForm()">
        <div class="login-header">
            <h1>NMAP Dashboard</h1>
            <p>Sign in to continue</p>
        </div>

        <div x-show="error" x-cloak class="alert alert-error">
            <span x-text="error"></span>
        </div>

        <form @submit.prevent="submit">
            <div class="form-group">
                <label class="form-label" for="username">Username</label>
                <input type="text" id="username" class="form-input" placeholder="Username" x-model="username" required autofocus>
            </div>

            <div class="form-group">
                <label class="form-label" for="password">Password</label>
                <input type="password" id="password" class="form-input" placeholder="Password" x-model="password" required>
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%;" :disabled="loading">
                <span x-show="!loading">Sign In</span>
                <span x-show="loading" class="loading-spinner"></span>
            </button>
        </form>

        <p class="text-center text-muted text-sm mt-3">
            Need an account? <a href="/register.html" style="color: var(--accent-green-bright);">Register</a>
        </p>
    </div>
</div>

<script>
function loginForm() {
    return {
        username: '',
        password: '',
        error: '',
        loading: false,

        async submit() {
            this.error = '';
            this.loading = true;

            try {
                const response = await API.post('/auth/login', {
                    user: this.username,
                    password: this.password
                });

                if (response.status === 'success') {
                    window.location.href = '/main.html';
                } else {
                    this.error = response.message || 'Login failed';
                }
            } catch (err) {
                this.error = err.message || 'Login failed';
            } finally {
                this.loading = false;
            }
        }
    };
}
</script>

{{ template "footer.html" . }}
